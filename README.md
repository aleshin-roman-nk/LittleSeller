# LittleSeller

**LittleSeller** — кассовое приложение для выездной кухни (laptop POS).  
Помогает вести базу блюд, собирать сменное меню из базы, печатать меню, открывать/закрывать смены и оформлять чеки с отправкой в фискальный накопитель и на удалённый сервер статистики продаж.

---

## Возможности

- Редактируемая база блюд (добавление/изменение).
- Создание **сменного меню** путём добавления блюд из базы.
- Генерация и печать сменного меню с категориями (супы, гарниры, напитки и т.д.).
- Открытие / закрытие смены.
- Открытие / закрытие чека.
- Отправка чека в интегрированный фискальный накопитель.
- Отправка чека на удалённый сервер статистики продаж.
- **Надёжная отправка чеков** на сервер:
  - устойчивость к плохому интернету,
  - асинхронная отправка в отдельном потоке,
  - предотвращение дублирования чеков на сервере.

## Скриншоты
![Главный экран](docs/images/main.png)
![Сменное меню](docs/images/menu.png)
![Чек](docs/images/print.png)

---

## Технологии

### Desktop (WinForms)
- WinForms
- Entity Framework
- SQLite
- `async/await`
- `lock`
- Архитектура: **MVP (Model–View–Presenter)**

### Server
- PHP (самописный движок)
- MySQL

---

## Архитектурная идея (коротко)

- UI построен в стиле **MVP**: логика вынесена в Presenter, UI остаётся максимально “тонким”.
- Отправка чеков на сервер работает **асинхронно** и не блокирует кассу при плохом интернете.
- Для надёжности используется механизм гарантированной доставки и защита от дублей (идемпотентность на стороне сервера / проверка уникальности чеков — концептуально).

---

## Структура репозитория

```txt
/Desktop   - касса на WinForms
/Server    - PHP-сервер статистики продаж
```

## Запуск (Desktop)

### Требования
- Windows
- .NET Framework
- Visual Studio

### Важно про базу данных (SQLite)
Проект использует **готовый SQLite-файл**, который создавался вручную (миграций EF нет).
Чтобы приложение стартовало корректно, нужен файл базы данных с уже подготовленной схемой.

**Что сделать:**
1. Возьмите файл базы данных: `Desktop\LettleSeller\kassa.db`.
2. Поместите его в: `Desktop\LettleSeller\bin\db\`.

## Запуск (Server, PHP) — статус

В репозитории есть папка `/Server` с PHP-частью (сервер статистики продаж).

⚠️ В текущем виде серверная часть **не является полностью воспроизводимой из репозитория**, потому что:
- база MySQL и таблицы создавались вручную через phpMyAdmin (без миграций/SQL-дампа),
- развёртывание выполнялось вручную (например, загрузкой файлов на хостинг по FTP),
- точные шаги и схема БД сейчас не зафиксированы в виде скриптов.

### Что это значит
- Код `/Server` можно использовать как **reference** (пример реализации и логики),
- но «поднять сервер с нуля» стороннему человеку сейчас будет сложно без дополнительной документации/дампа БД.

### План (Roadmap)
- [ ] Добавить SQL-дамп (schema.sql) или миграции/скрипт создания таблиц
- [ ] Описать настройку конфигов и окружения
- [ ] Упаковать сервер в Docker для простого запуска

## Автор
- GitHub: [aleshin-roman-nk](https://github.com/aleshin-roman-nk)
- LinkedIn: [Roman Aleshin](https://www.linkedin.com/in/roman-aleshin)